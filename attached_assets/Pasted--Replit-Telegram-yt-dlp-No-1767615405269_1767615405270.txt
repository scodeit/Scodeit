Ты — автономный инженер в Replit. Сделай минимальный, надёжный Telegram-бот-обёртку для yt-dlp на Node.js.

Цель
- Пользователь присылает команду в формате аргументов yt-dlp.
- Бот запускает yt-dlp, скачивает файл во временную папку.
- Бот ПЫТАЕТСЯ отправить файл пользователю.
- Если Telegram принимает файл — отлично.
- Если Telegram ОТКАЗЫВАЕТ (слишком большой файл, неподдерживаемый тип и т.п.) — бот сообщает об этом пользователю и предлагает изменить аргументы.
- В любом случае (успех или ошибка) бот удаляет все скачанные файлы.

Жёсткие ограничения (важно)
1) Бот принимает только сообщения вида:
   /dl <args...>
2) Любые другие сообщения:
   - игнорировать
   - или отвечать: “Используй /dl <yt-dlp args>”
3) Никаких других команд, фич, БД, истории, состояний.
4) Безопасность:
   - НЕЛЬЗЯ выполнять shell-строку.
   - Использовать ТОЛЬКО spawn / execFile с массивом аргументов.
5) Разбор аргументов:
   - Безопасный CLI-парсер.
   - Учитывать кавычки.
   - Запрещать опасные флаги (см. ниже).

Запрещённые аргументы yt-dlp (обязательно отклонять)
- -U, --update
- --rm-cache-dir
- --exec
- --postprocessor-args
- --config-location
- --paths, -P
- -o, --output
- --print, --dump-json
- --cookies-from-browser
- --username, --password, --netrc
- --proxy
- --cache-dir
- --write-info-json
- --write-description
- --write-thumbnail

Причина: безопасность, утечки, мусор на диске.

Принудительные правила загрузки
- Пользователь НЕ МОЖЕТ управлять путями и именами файлов.
- Всегда использовать свой output template:
  <TMP_DIR>/%(title).120B [%(id)s].%(ext)s
- Всегда скачивать ТОЛЬКО в TMP_DIR.
- Создавать TMP_DIR при старте, если его нет.

Размер файлов
- НЕ ограничивать размер через yt-dlp.
- Бот должен:
  1) скачать файл полностью,
  2) попытаться отправить его в Telegram,
  3) если Telegram возвращает ошибку (например “file is too big”):
     - сообщить пользователю кратко:
       “Файл слишком большой для Telegram. Попробуй изменить аргументы (формат, качество, аудио и т.п.).”
     - НЕ считать это фатальной ошибкой,
     - ОБЯЗАТЕЛЬНО удалить файл.

Удаление и очистка (критично)
- После ЛЮБОГО исхода:
  - удалить скачанный файл,
  - удалить .part / .temp файлы,
  - удалить пустые директории.
- Реализовать:
  - cleanup в finally-блоке,
  - фоновую TTL-очистку TMP_DIR (например каждые 30 минут удалять файлы старше CLEANUP_TTL_MIN).

Telegram поведение
- Отправлять файл как document (универсально).
- Не пытаться “угадывать” video/audio тип.
- Если отправка не удалась:
  - поймать исключение,
  - распарсить сообщение Telegram API,
  - ответить пользователю человекочитаемо,
  - продолжить cleanup.

Окружение / зависимости
- Node.js 18+
- Telegram SDK: grammY или telegraf (выбери одну)
- yt-dlp:
  - либо доступен в PATH,
  - либо скачивается при старте в ./bin/yt-dlp
- ffmpeg НЕ обязателен

ENV
- BOT_TOKEN (обязательно)
- YTDLP_PATH (опционально)
- TMP_DIR (по умолчанию ./tmp)
- CLEANUP_TTL_MIN (по умолчанию 30)

Команды
- /start → краткая инструкция
- /dl <args>

Примеры допустимых команд
- /dl https://youtu.be/XXXX
- /dl -f bestvideo+bestaudio https://youtube.com/watch?v=XXXX
- /dl -f bestaudio --extract-audio https://...

Валидация
- В args должен быть хотя бы один http/https URL.
- Пустые args → отказ.
- Запрещённые флаги → отказ с причиной.

Запуск yt-dlp
- spawn(YTDLP_PATH, argv)
- Всегда добавлять:
  --newline
  --no-playlist
  -o <outtmpl>
- stdout/stderr буферизовать с лимитом (для сообщений об ошибке).

Определение результата
- После завершения yt-dlp:
  - найти самый свежий файл в TMP_DIR,
  - убедиться что это не .part,
  - попытаться отправить его.

Структура проекта
- package.json
- src/index.js
- src/parseArgs.js
- src/validate.js
- src/ytdlp.js
- src/cleanup.js
- .env.example
- README.md

Критерий готовности
- Бот скачивает любой размер.
- Если Telegram не принимает файл — пользователь получает понятный ответ.
- TMP_DIR всегда очищается.
- Ни одна строка пользователя не исполняется как shell.

Сделай это максимально простым и надёжным. Никаких лишних идей.
